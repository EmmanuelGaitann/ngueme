{% extends 'base_pwa.html' %}
{% load static %}

{% block title %}Mon Profil{% endblock %}

{% block content %}
<div style="padding:10px 14px 100px;">

  <!-- Avatar + infos -->
  <div class="card" style="margin-bottom:12px;text-align:center;padding:20px;">
    <div class="avatar-lg" style="width:64px;height:64px;font-size:22px;margin:0 auto 10px;">{{ user.get_initials }}</div>
    <p class="serif" style="font-size:17px;font-weight:700;">{{ user.get_full_name }}</p>
    <p style="font-size:12px;color:var(--ink3);margin-bottom:8px;">{{ user.email }}</p>
    <span class="chip chip-{% if user.plan == 'pro' %}indigo{% else %}amber{% endif %}">
      <i class="fa-solid fa-{% if user.plan == 'pro' %}crown{% else %}seedling{% endif %}" style="font-size:9px;"></i>
      Plan {{ user.get_plan_display }}
    </span>
  </div>

  <!-- Catégories (lien prominent) -->
  <a href="{% url 'transactions:categories' %}" style="text-decoration:none;display:block;margin-bottom:12px;">
    <div style="display:flex;align-items:center;gap:12px;padding:14px;border-radius:14px;
      background:rgba(184,112,32,.08);border:1.5px solid rgba(184,112,32,.25);">
      <div style="width:40px;height:40px;border-radius:10px;background:rgba(184,112,32,.15);display:flex;align-items:center;justify-content:center;flex-shrink:0;">
        <i class="fa-solid fa-tags" style="color:var(--sienna);font-size:16px;"></i>
      </div>
      <div style="flex:1;">
        <p style="font-size:13px;font-weight:700;color:var(--sienna);">Gérer les catégories</p>
        <p style="font-size:11px;color:var(--ink3);">Dépenses, revenus & budgets</p>
      </div>
      <i class="fa-solid fa-chevron-right" style="color:var(--sienna);font-size:11px;"></i>
    </div>
  </a>

  <!-- Formulaire profil -->
  <div class="card" style="border-top:3px solid var(--sienna);margin-bottom:12px;">
    <p style="font-size:13px;font-weight:700;margin-bottom:14px;">
      <i class="fa-solid fa-user" style="color:var(--sienna);margin-right:7px;"></i>Mes informations
    </p>
    <form method="post">
      {% csrf_token %}
      <div style="display:flex;flex-direction:column;gap:10px;">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <div>
            <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">PRÉNOM</label>
            {{ form.first_name }}
          </div>
          <div>
            <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">NOM</label>
            {{ form.last_name }}
          </div>
        </div>
        <div>
          <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">EMAIL</label>
          {{ form.email }}
        </div>
        <div>
          <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">TÉLÉPHONE</label>
          {{ form.phone }}
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <div>
            <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">VILLE</label>
            {{ form.city }}
          </div>
          <div>
            <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">PAYS</label>
            {{ form.country }}
          </div>
        </div>
        <div>
          <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">PROFESSION</label>
          {{ form.profession }}
        </div>
        <div>
          <label style="font-size:10px;color:var(--ink3);font-weight:700;display:block;margin-bottom:4px;">OBJECTIF REVENU MENSUEL (FCFA)</label>
          {{ form.monthly_income_target }}
        </div>
        <button type="submit" class="btn-primary btn-sienna" style="width:100%;">
          <i class="fa-solid fa-floppy-disk" style="margin-right:7px;"></i>Enregistrer
        </button>
      </div>
    </form>
  </div>

  <!-- Sécurité -->
  <div class="card" style="border-top:3px solid var(--amber);margin-bottom:12px;">
    <p style="font-size:13px;font-weight:700;margin-bottom:12px;">
      <i class="fa-solid fa-key" style="color:var(--amber);margin-right:7px;"></i>Sécurité
    </p>
    <div style="display:flex;flex-direction:column;gap:8px;">
      <a href="{% url 'accounts:password_change' %}" style="display:flex;align-items:center;gap:10px;padding:12px;border-radius:10px;background:var(--amber-l);text-decoration:none;">
        <i class="fa-solid fa-key" style="color:var(--amber);width:16px;text-align:center;"></i>
        <p style="font-size:13px;font-weight:700;color:var(--amber);">Changer le mot de passe</p>
        <i class="fa-solid fa-chevron-right" style="color:var(--amber);font-size:10px;margin-left:auto;"></i>
      </a>
      <a href="{% url 'accounts:logout' %}" style="display:flex;align-items:center;gap:10px;padding:12px;border-radius:10px;background:var(--danger-l);text-decoration:none;">
        <i class="fa-solid fa-right-from-bracket" style="color:var(--danger);width:16px;text-align:center;"></i>
        <p style="font-size:13px;font-weight:700;color:var(--danger);">Se déconnecter</p>
        <i class="fa-solid fa-chevron-right" style="color:var(--danger);font-size:10px;margin-left:auto;"></i>
      </a>
    </div>
  </div>

  {% if user.plan == 'free' %}
  <!-- Upgrade Pro -->
  <div class="card" style="border-top:3px solid var(--indigo);">
    <p style="font-size:13px;font-weight:700;margin-bottom:6px;">
      <i class="fa-solid fa-crown" style="color:var(--indigo);margin-right:7px;"></i>Plan Gratuit actif
    </p>
    <p style="font-size:12px;color:var(--ink3);margin-bottom:12px;">Passez Pro pour débloquer toutes les fonctionnalités.</p>
    <a href="{% url 'accounts:upgrade' %}" class="btn-primary" style="background:var(--indigo);text-decoration:none;display:block;text-align:center;">
      <i class="fa-solid fa-crown" style="margin-right:6px;"></i>Passer Pro
    </a>
  </div>
  {% endif %}

</div>
{% endblock %}
