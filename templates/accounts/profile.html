{% extends 'base_desktop.html' %}
{% block title %}Profil{% endblock %}
{% block page_title %}Mon profil{% endblock %}

{% block content %}
<div style="max-width:680px;">
  <div class="card" style="margin-bottom:16px;">
    <div style="display:flex;align-items:center;gap:16px;margin-bottom:20px;padding-bottom:18px;border-bottom:1px solid var(--s2);">
      <div class="avatar-lg" style="width:64px;height:64px;font-size:22px;">{{ user.get_initials }}</div>
      <div>
        <p class="serif" style="font-size:18px;font-weight:700;">{{ user.get_full_name }}</p>
        <p style="font-size:13px;color:var(--ink3);">{{ user.email }}</p>
        <span class="chip chip-{% if user.plan == 'pro' %}indigo{% else %}amber{% endif %}" style="margin-top:6px;">
          <i class="fa-solid fa-{% if user.plan == 'pro' %}crown{% else %}seedling{% endif %}" style="font-size:9px;"></i>
          Plan {{ user.get_plan_display }}
        </span>
      </div>
    </div>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
        <div>
          <label class="field-label">PRÉNOM</label>
          {{ form.first_name }}
        </div>
        <div>
          <label class="field-label">NOM</label>
          {{ form.last_name }}
        </div>
        <div>
          <label class="field-label">EMAIL</label>
          {{ form.email }}
        </div>
        <div>
          <label class="field-label">TÉLÉPHONE</label>
          {{ form.phone }}
        </div>
        <div>
          <label class="field-label">VILLE</label>
          {{ form.city }}
        </div>
        <div>
          <label class="field-label">PAYS</label>
          {{ form.country }}
        </div>
        <div style="grid-column:1/3;">
          <label class="field-label">PROFESSION</label>
          {{ form.profession }}
        </div>
        <div style="grid-column:1/3;">
          <label class="field-label">OBJECTIF REVENU MENSUEL (FCFA)</label>
          {{ form.monthly_income_target }}
        </div>
      </div>
      <button type="submit" class="btn-primary btn-sienna" style="width:auto;padding:10px 24px;">
        <i class="fa-solid fa-floppy-disk" style="margin-right:7px;"></i>Enregistrer les modifications
      </button>
    </form>
  </div>

  <div class="card" style="border-left:3px solid var(--sienna);margin-top:16px;">
    <p style="font-size:13px;font-weight:700;margin-bottom:8px;">
      <i class="fa-solid fa-tags" style="color:var(--sienna);margin-right:7px;"></i>Catégories
    </p>
    <p style="font-size:12px;color:var(--ink3);margin-bottom:12px;">Gérez vos catégories de dépenses et revenus (journal & budgets).</p>
    <a href="{% url 'transactions:categories' %}" style="display:inline-flex;align-items:center;gap:7px;padding:9px 16px;border-radius:9px;background:rgba(184,112,32,.1);color:var(--sienna);font-size:13px;font-weight:700;text-decoration:none;">
      <i class="fa-solid fa-tags"></i>Gérer les catégories
    </a>
  </div>

  <div class="card" style="border-left:3px solid var(--amber);margin-top:16px;">
    <p style="font-size:13px;font-weight:700;margin-bottom:12px;">
      <i class="fa-solid fa-key" style="color:var(--amber);margin-right:7px;"></i>Sécurité
    </p>
    <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
      <a href="{% url 'accounts:password_change' %}" style="display:inline-flex;align-items:center;gap:7px;padding:9px 16px;border-radius:9px;background:var(--amber-l);color:var(--amber);font-size:13px;font-weight:700;text-decoration:none;">
        <i class="fa-solid fa-key"></i>Changer le mot de passe
      </a>
      <a href="{% url 'accounts:logout' %}" style="display:inline-flex;align-items:center;gap:6px;padding:9px 16px;border-radius:9px;background:var(--danger-l);color:var(--danger);font-size:13px;font-weight:700;text-decoration:none;">
        <i class="fa-solid fa-right-from-bracket"></i>Se déconnecter
      </a>
    </div>
  </div>

  {% if user.plan == 'free' %}
  <div class="card" style="border-left:3px solid var(--indigo);margin-top:16px;">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
      <div>
        <p style="font-size:13px;font-weight:700;margin-bottom:4px;">
          <i class="fa-solid fa-crown" style="color:var(--indigo);margin-right:7px;"></i>Plan Gratuit actif
        </p>
        <p style="font-size:12px;color:var(--ink3);">Passez Pro pour débloquer toutes les fonctionnalités</p>
      </div>
      <a href="{% url 'accounts:upgrade' %}" class="btn-primary" style="background:var(--indigo);width:auto;padding:9px 18px;text-decoration:none;font-size:13px;">
        <i class="fa-solid fa-crown" style="margin-right:6px;"></i>Passer Pro
      </a>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
